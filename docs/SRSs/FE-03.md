# FE-03: Quản lý Hộ khẩu (Apartment Management)

## 1. Tổng quan

Module này hỗ trợ quản lý các Căn hộ/Hộ khẩu. Quản trị viên có thể tạo căn hộ mới, xem chi tiết thông tin và quản lý danh sách thành viên trong từng hộ.
Tương ứng với các ticket Backend: `BE-07`, `BE-08`, `BE-09`.

## 2. Đặc tả giao diện (UI Specifications)

### Các thành phần (Components)

- **Apartment List (Danh sách hộ)**:
  - Bảng hiển thị: `Số phòng`, `Tòa nhà`, `Tên chủ hộ`, `Diện tích`.
  - Hành động: "Xem chi tiết".
- **Apartment Create Form (Tạo hộ mới)**:
  - `Tên hộ` (Name - Vd: "Gia đình ông A").
  - `Số phòng` (Apartment Number - Vd: "101").
  - `Tòa nhà` (Building - Vd: "A").
  - `Diện tích` (Area - Số, m2).
- **Apartment Detail View (Chi tiết hộ)**:
  - **Info Card**: Hiển thị thông tin chung (Diện tích, Tòa nhà...).
  - **Members Table (Danh sách thành viên)**:
    - Cột: `Họ tên`, `Vai trò` (Chủ hộ/Thành viên), `CCCD`.
  - **Add Member Form (Modal/Inline)**:
    - `Cư dân` (Resident): Dropdown tìm kiếm (Chọn từ danh sách Nhân khẩu có sẵn).
    - `Vai trò` (Role): Select (Chủ hộ / Thành viên).

### Ánh xạ dữ liệu (Data Mapping)

| Nhãn trường (Label)   | Tên biến FE       | Key Payload (API) | Kiểu        | Ghi chú                    |
| :-------------------- | :---------------- | :---------------- | :---------- | :------------------------- |
| Tên hộ                | `name`            | `name`            | String      |                            |
| Số phòng              | `apartmentNumber` | `apartmentNumber` | String      |                            |
| Tòa nhà               | `building`        | `building`        | String      |                            |
| Diện tích             | `area`            | `area`            | Number      |                            |
| Thành viên -> Cư dân  | `residentId`      | `residentId`      | String (ID) | Chọn từ DS Nhân khẩu       |
| Thành viên -> Vai trò | `role`            | `role`            | String      | "Chủ hộ" hoặc "Thành viên" |

## 3. Luồng xử lý & Tương tác (Flow & Interaction)

### 3.1. Tạo Hộ khẩu

1. Click "Tạo Hộ khẩu".
2. Điền Form (`name`, `area`, ...).
3. Gửi `POST /api/apartments`.
4. Chuyển hướng về Danh sách hoặc trang Chi tiết vừa tạo.

### 3.2. Xem Chi tiết

1. Click vào một căn hộ trong danh sách.
2. Điều hướng đến `/apartments/[id]`.
3. Fetch dữ liệu `GET /api/apartments/:id`.
4. Render thông tin chung và danh sách thành viên.

### 3.3. Thêm thành viên vào Hộ

1. Tại trang Chi tiết, click "Thêm thành viên".
2. Tìm kiếm và chọn một Cư dân (theo Tên/ID).
3. Chọn Vai trò.
4. Click "Thêm".
5. Gọi `POST /api/apartments/:id/members`.
6. Refresh lại danh sách thành viên.

## 4. Chi tiết triển khai kỹ thuật (Technical Implementation Details)

### API Endpoints

- **Create**: `POST /api/apartments`
- **Get Details**: `GET /api/apartments/:id` (Trả về `{ data: { ..., members: [...] } }`)
- **Add Member**: `POST /api/apartments/:id/members`
- **List**: `GET /api/apartments` (Sử dụng logic tương tự BE-14 hoặc endpoint list cơ bản).

### Logic Frontend

- **Chọn thành viên**: Cần fetch "Danh sách Nhân khẩu" để đổ vào dropdown. Sử dụng ComboBox có tính năng search/autocomplete để xử lý danh sách dài.
- **Logic Vai trò**: Validate logic nghiệp vụ (nếu có) ví dụ: Một hộ chỉ có 1 Chủ hộ.

## 5. Git Branch

**Branch name**: `feature/FE-03-apartment-management`