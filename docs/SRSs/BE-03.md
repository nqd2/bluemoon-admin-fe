### PHẦN 1: TÀI LIỆU KỸ THUẬT (SRS) CHO TICKET [BE-03]

#### **Ticket: [BE-03] Auth Middleware**

**1. Thông tin chung**

- **Assignee:** Nguyễn Quý Đức (Fullstack Lead)
- **Branch Name:** `feature/BE-03-auth-middleware`
- **Estimated Time:** 1h

**2. Mô tả (Description)**
Xây dựng Middleware để bảo vệ các private routes. Middleware này sẽ chặn các request không có Token hoặc Token không hợp lệ.

**3. Yêu cầu kỹ thuật (Technical Specs)**

- **Location:** `src/middlewares/auth.middleware.ts`
- **Logic:**
  1.  Lấy token từ Header `Authorization`. Format: `Bearer <token>`.
  2.  Nếu không có token -> Trả về lỗi 401.
  3.  Verify token bằng `jsonwebtoken`.
  4.  Nếu token hợp lệ -> Decode lấy `id` user -> Tìm user trong DB -> Gán vào `req.user`.
  5.  Nếu token hết hạn hoặc không hợp lệ -> Trả về lỗi 401.

**4. Acceptance Criteria (Tiêu chí chấp nhận)**

- [x] **Header Check:** Kiểm tra sự tồn tại của header `Authorization` bắt đầu bằng `Bearer`.
- [x] **Token Verification:** Sử dụng `jwt.verify` để kiểm tra tính hợp lệ của token với `JWT_SECRET`.
- [x] **User Attachment:** Nếu token đúng, thông tin user (từ DB, bỏ password) phải được gán vào `req.user` để các controller phía sau sử dụng.
- [x] **Error Handling:**
  - Không có token: `401 Not authorized, no token`.
  - Token sai/hết hạn: `401 Not authorized, token failed`.
