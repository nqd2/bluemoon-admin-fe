### PHẦN 1: TÀI LIỆU KỸ THUẬT (SRS) CHO TICKET [BE-08]

#### **Ticket: [BE-08] Add Member to Apartment (Thêm người vào hộ)**

**1. Thông tin chung**

* **Assignee:** Backend Dev
* **Branch Name:** `feature/BE-08-add-member`
* **Estimated Time:** 2h

**2. Mô tả (Description)**
API thêm một nhân khẩu vào một căn hộ với vai trò cụ thể (Chủ hộ hoặc Thành viên).

**3. Yêu cầu kỹ thuật (Technical Specs)**

*   **Endpoint:** `POST /api/apartments/:id/members`
*   **Payload:**
    ```json
    {
      "residentId": "resident_object_id",
      "role": "Thành viên" // hoặc "Chủ hộ"
    }
    ```
*   **Logic:** Transaction (nếu cần) hoặc update 2 collection tuần tự.
    1.  Update `Residents`: Set `apartmentId` = `:id`, `role` = payload.role.
    2.  Update `Apartments`: Push `residentId` vào mảng `members`. Nếu role là Chủ hộ, update `ownerId`.

**4. Acceptance Criteria (Tiêu chí chấp nhận)**

* [ ] **Owner Check:** Nếu `role` là 'Chủ hộ', kiểm tra xem căn hộ này đã có chủ hộ chưa. Nếu có rồi -> Trả về lỗi 400 (Một hộ chỉ có 1 chủ hộ).
* [ ] **Consistency:** Dữ liệu phải được cập nhật đồng bộ ở cả 2 bảng `Residents` và `Apartments`.
* [ ] **Validation:** Kiểm tra `residentId` và `apartmentId` hợp lệ.
